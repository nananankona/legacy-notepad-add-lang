From 66b2a9ff86351b57a21926bc04c295b0060aec29 Mon Sep 17 00:00:00 2001
From: yukkuriremiria <konana.net@proton.me>
Date: Sun, 1 Feb 2026 00:24:21 +0900
Subject: [PATCH 1/3] update

---
 CMakeLists.txt           |   2 +
 src/core/types.h         |   1 +
 src/lang/en.h            | 118 ++++++++++++++++++++++++++++++++++
 src/lang/ja.h            | 118 ++++++++++++++++++++++++++++++++++
 src/lang/lang.cpp        |  75 ++++++++++++++++++++++
 src/lang/lang.h          | 135 +++++++++++++++++++++++++++++++++++++++
 src/main.cpp             |  39 ++++++++++-
 src/modules/commands.cpp |  29 +++++++--
 src/modules/commands.h   |   1 +
 src/modules/dialog.cpp   |  97 ++++++++++++++++------------
 src/modules/editor.cpp   |  17 +----
 src/modules/file.cpp     |  33 ++++++----
 src/modules/menu.cpp     | 133 ++++++++++++++++++++++++++++++++++++++
 src/modules/menu.h       |   7 ++
 src/modules/ui.cpp       |  15 ++++-
 src/notepad.rc           |   7 ++
 src/resource.h           |   5 ++
 17 files changed, 756 insertions(+), 76 deletions(-)
 create mode 100644 src/lang/en.h
 create mode 100644 src/lang/ja.h
 create mode 100644 src/lang/lang.cpp
 create mode 100644 src/lang/lang.h
 create mode 100644 src/modules/menu.cpp
 create mode 100644 src/modules/menu.h

diff --git a/CMakeLists.txt b/CMakeLists.txt
index a94f709..2f86848 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -19,6 +19,7 @@ endif()
 add_executable(legacy-notepad WIN32
     src/main.cpp
     src/core/globals.cpp
+    src/lang/lang.cpp
     src/modules/theme.cpp
     src/modules/editor.cpp
     src/modules/file.cpp
@@ -26,6 +27,7 @@ add_executable(legacy-notepad WIN32
     src/modules/background.cpp
     src/modules/dialog.cpp
     src/modules/commands.cpp
+    src/modules/menu.cpp
     src/notepad.rc
 )
 
diff --git a/src/core/types.h b/src/core/types.h
index 07b8389..bdf2abd 100644
--- a/src/core/types.h
+++ b/src/core/types.h
@@ -117,6 +117,7 @@ struct AppState
     int fontSize = 16;
     std::wstring fontName = L"Consolas";
     BYTE windowOpacity = 255;
+    bool alwaysOnTop = false;
     bool closing = false;
     HFONT hFont = nullptr;
     std::deque<std::wstring> recentFiles;
diff --git a/src/lang/en.h b/src/lang/en.h
new file mode 100644
index 0000000..28f88a6
--- /dev/null
+++ b/src/lang/en.h
@@ -0,0 +1,118 @@
+#pragma once
+
+#include "lang.h"
+
+inline LangStrings g_langEN = {
+    // App
+    L"Notepad",
+    L"Untitled",
+
+    // Menu - File
+    L"&File",
+    L"&New\tCtrl+N",
+    L"&Open...\tCtrl+O",
+    L"&Save\tCtrl+S",
+    L"Save &As...\tCtrl+Shift+S",
+    L"&Print...\tCtrl+P",
+    L"Page Set&up...",
+    L"E&xit",
+    L"Recent Files",
+
+    // Menu - Edit
+    L"&Edit",
+    L"&Undo\tCtrl+Z",
+    L"&Redo\tCtrl+Y",
+    L"Cu&t\tCtrl+X",
+    L"&Copy\tCtrl+C",
+    L"&Paste\tCtrl+V",
+    L"De&lete\tDel",
+    L"&Find...\tCtrl+F",
+    L"Find &Next\tF3",
+    L"Find Pre&vious\tShift+F3",
+    L"&Replace...\tCtrl+H",
+    L"&Go To...\tCtrl+G",
+    L"Select &All\tCtrl+A",
+    L"Time/&Date\tF5",
+
+    // Menu - Format
+    L"F&ormat",
+    L"&Word Wrap",
+    L"&Font...",
+
+    // Menu - View
+    L"&View",
+    L"Zoom &In\tCtrl+Plus",
+    L"Zoom &Out\tCtrl+Minus",
+    L"&Restore Default Zoom\tCtrl+0",
+    L"&Status Bar",
+    L"&Dark Mode",
+    L"&Background",
+    L"&Select Image...",
+    L"&Clear Background",
+    L"&Opacity...",
+    L"&Position",
+    L"Top Left",
+    L"Top Center",
+    L"Top Right",
+    L"Center Left",
+    L"Center",
+    L"Center Right",
+    L"Bottom Left",
+    L"Bottom Center",
+    L"Bottom Right",
+    L"Tile",
+    L"Stretch",
+    L"Fit",
+    L"Fill",
+    L"Window &Transparency...",
+    L"Always on &Top",
+
+    // Menu - Help
+    L"&Help",
+    L"&About Notepad",
+
+    // Menu - Language
+    L"&Language",
+    L"&English",
+    L"&Japanese",
+
+    // Dialogs
+    L"Find",
+    L"Find and Replace",
+    L"Go To Line",
+    L"Window Transparency",
+    L"Find:",
+    L"Replace:",
+    L"Find Next",
+    L"Replace",
+    L"Replace All",
+    L"Close",
+    L"Line number:",
+    L"OK",
+    L"Cancel",
+    L"Opacity (10-100%):",
+
+    // Messages
+    L"Cannot find \"",
+    L"Do you want to save changes to ",
+    L"Cannot open file.",
+    L"Cannot save file.",
+    L"Error",
+    L"Legacy Notepad v1.1.0\n\nA fast, lightweight text editor.\n\nBuilt with C++ and Win32 API.\n\nModify by 0x2o.net",
+
+    // Status bar
+    L" Ln ",
+    L", Col ",
+
+    // Encoding names
+    L"UTF-8",
+    L"UTF-8 with BOM",
+    L"UTF-16 LE",
+    L"UTF-16 BE",
+    L"ANSI",
+
+    // Line ending names
+    L"Windows (CRLF)",
+    L"Unix (LF)",
+    L"Macintosh (CR)"
+};
diff --git a/src/lang/ja.h b/src/lang/ja.h
new file mode 100644
index 0000000..3914e02
--- /dev/null
+++ b/src/lang/ja.h
@@ -0,0 +1,118 @@
+#pragma once
+
+#include "lang.h"
+
+inline LangStrings g_langJA = {
+    // App
+    L"メモ帳",
+    L"無題",
+
+    // Menu - File
+    L"ファイル(&F)",
+    L"新規(&N)\tCtrl+N",
+    L"開く(&O)...\tCtrl+O",
+    L"上書き保存(&S)\tCtrl+S",
+    L"名前を付けて保存(&A)...\tCtrl+Shift+S",
+    L"印刷(&P)...\tCtrl+P",
+    L"ページ設定(&U)...",
+    L"終了(&X)",
+    L"最近使ったファイル",
+
+    // Menu - Edit
+    L"編集(&E)",
+    L"元に戻す(&U)\tCtrl+Z",
+    L"やり直し(&R)\tCtrl+Y",
+    L"切り取り(&T)\tCtrl+X",
+    L"コピー(&C)\tCtrl+C",
+    L"貼り付け(&P)\tCtrl+V",
+    L"削除(&L)\tDel",
+    L"検索(&F)...\tCtrl+F",
+    L"次を検索(&N)\tF3",
+    L"前を検索(&V)\tShift+F3",
+    L"置換(&H)...\tCtrl+H",
+    L"ジャンプ(&G)...\tCtrl+G",
+    L"すべて選択(&A)\tCtrl+A",
+    L"日時(&D)\tF5",
+
+    // Menu - Format
+    L"書式(&O)",
+    L"折り返し(&W)",
+    L"フォント(&F)...",
+
+    // Menu - View
+    L"表示(&V)",
+    L"拡大(&I)\tCtrl+Plus",
+    L"縮小(&O)\tCtrl+Minus",
+    L"既定のサイズに戻す(&R)\tCtrl+0",
+    L"ステータスバー(&S)",
+    L"ダークモード(&D)",
+    L"背景(&B)",
+    L"画像を選択(&S)...",
+    L"背景をクリア(&C)",
+    L"不透明度(&O)...",
+    L"位置(&P)",
+    L"左上",
+    L"上中央",
+    L"右上",
+    L"中央左",
+    L"中央",
+    L"中央右",
+    L"左下",
+    L"下中央",
+    L"右下",
+    L"並べて表示",
+    L"拡大",
+    L"サイズに合わせる",
+    L"フィル",
+    L"ウィンドウの透明度(&T)...",
+    L"常に最前面に表示(&T)",
+
+    // Menu - Help
+    L"ヘルプ(&H)",
+    L"メモ帳について(&A)",
+
+    // Menu - Language
+    L"言語(&L)",
+    L"英語(&E)",
+    L"日本語(&J)",
+
+    // Dialogs
+    L"検索",
+    L"検索と置換",
+    L"行へジャンプ",
+    L"ウィンドウの透明度",
+    L"検索:",
+    L"置換:",
+    L"次を検索",
+    L"置換",
+    L"すべて置換",
+    L"閉じる",
+    L"行番号:",
+    L"OK",
+    L"キャンセル",
+    L"不透明度 (10-100%):",
+
+    // Messages
+    L"「",
+    L"次のファイルに変更を保存しますか: ",
+    L"ファイルを開けません。",
+    L"ファイルを保存できません。",
+    L"エラー",
+    L"Legacy Notepad v1.1.0\n\n高速で軽量なテキストエディタ。\n\nC++ Win32 API で構築。\n\nModify by 0x2o.net",
+
+    // Status bar
+    L" 行 ",
+    L", 列 ",
+
+    // Encoding names
+    L"UTF-8",
+    L"UTF-8 (BOM付き)",
+    L"UTF-16 LE",
+    L"UTF-16 BE",
+    L"ANSI",
+
+    // Line ending names
+    L"Windows (CRLF)",
+    L"Unix (LF)",
+    L"Macintosh (CR)"
+};
diff --git a/src/lang/lang.cpp b/src/lang/lang.cpp
new file mode 100644
index 0000000..7f434a3
--- /dev/null
+++ b/src/lang/lang.cpp
@@ -0,0 +1,75 @@
+#include "lang.h"
+#include "en.h"
+#include "ja.h"
+#include <windows.h>
+
+static LangID g_currentLang = LangID::EN;
+static const LangStrings *g_currentStrings = &g_langEN;
+
+LangID LoadLanguageSetting()
+{
+    HKEY hKey;
+    if (RegOpenKeyExW(HKEY_CURRENT_USER, L"Software\\LegacyNotepad", 0, KEY_READ, &hKey) == ERROR_SUCCESS)
+    {
+        DWORD value = 0, size = sizeof(value);
+        if (RegQueryValueExW(hKey, L"Language", nullptr, nullptr, reinterpret_cast<LPBYTE>(&value), &size) == ERROR_SUCCESS)
+        {
+            RegCloseKey(hKey);
+            return static_cast<LangID>(value);
+        }
+        RegCloseKey(hKey);
+    }
+    return LangID::EN;
+}
+
+void SaveLanguageSetting()
+{
+    HKEY hKey;
+    if (RegCreateKeyExW(HKEY_CURRENT_USER, L"Software\\LegacyNotepad", 0, nullptr, REG_OPTION_NON_VOLATILE, KEY_WRITE, nullptr, &hKey, nullptr) == ERROR_SUCCESS)
+    {
+        DWORD value = static_cast<DWORD>(g_currentLang);
+        RegSetValueExW(hKey, L"Language", 0, REG_DWORD, reinterpret_cast<const BYTE *>(&value), sizeof(value));
+        RegCloseKey(hKey);
+    }
+}
+
+void InitLanguage()
+{
+    LangID savedLang = LoadLanguageSetting();
+    SetLanguage(savedLang);
+}
+
+void SetLanguage(LangID lang)
+{
+    g_currentLang = lang;
+    
+    switch (lang)
+    {
+    case LangID::JA:
+        g_currentStrings = &g_langJA;
+        break;
+    case LangID::EN:
+    default:
+        g_currentStrings = &g_langEN;
+        break;
+    }
+    
+    SaveLanguageSetting();
+}
+
+LangID GetCurrentLanguage()
+{
+    return g_currentLang;
+}
+
+const LangStrings &GetLangStrings()
+{
+    return *g_currentStrings;
+}
+
+const std::wstring &GetString([[maybe_unused]] const std::wstring &key)
+{
+    static std::wstring empty;
+    return empty;
+}
+
diff --git a/src/lang/lang.h b/src/lang/lang.h
new file mode 100644
index 0000000..d48db63
--- /dev/null
+++ b/src/lang/lang.h
@@ -0,0 +1,135 @@
+#pragma once
+
+#include <windows.h>
+#include <string>
+
+enum class LangID
+{
+    EN, 
+    JA  
+};
+
+struct LangStrings
+{
+    // App
+    std::wstring appName;
+    std::wstring untitled;
+
+    // Menu - File
+    std::wstring menuFile;
+    std::wstring menuNew;
+    std::wstring menuOpen;
+    std::wstring menuSave;
+    std::wstring menuSaveAs;
+    std::wstring menuPrint;
+    std::wstring menuPageSetup;
+    std::wstring menuExit;
+    std::wstring menuRecentFiles;
+
+    // Menu - Edit
+    std::wstring menuEdit;
+    std::wstring menuUndo;
+    std::wstring menuRedo;
+    std::wstring menuCut;
+    std::wstring menuCopy;
+    std::wstring menuPaste;
+    std::wstring menuDelete;
+    std::wstring menuFind;
+    std::wstring menuFindNext;
+    std::wstring menuFindPrev;
+    std::wstring menuReplace;
+    std::wstring menuGoTo;
+    std::wstring menuSelectAll;
+    std::wstring menuTimeDate;
+
+    // Menu - Format
+    std::wstring menuFormat;
+    std::wstring menuWordWrap;
+    std::wstring menuFont;
+
+    // Menu - View
+    std::wstring menuView;
+    std::wstring menuZoomIn;
+    std::wstring menuZoomOut;
+    std::wstring menuZoomDefault;
+    std::wstring menuStatusBar;
+    std::wstring menuDarkMode;
+    std::wstring menuBackground;
+    std::wstring menuBgSelect;
+    std::wstring menuBgClear;
+    std::wstring menuBgOpacity;
+    std::wstring menuBgPosition;
+    std::wstring menuBgPosTopLeft;
+    std::wstring menuBgPosTopCenter;
+    std::wstring menuBgPosTopRight;
+    std::wstring menuBgPosCenterLeft;
+    std::wstring menuBgPosCenter;
+    std::wstring menuBgPosCenterRight;
+    std::wstring menuBgPosBottomLeft;
+    std::wstring menuBgPosBottomCenter;
+    std::wstring menuBgPosBottomRight;
+    std::wstring menuBgPosTile;
+    std::wstring menuBgPosStretch;
+    std::wstring menuBgPosFit;
+    std::wstring menuBgPosFill;
+    std::wstring menuTransparency;
+    std::wstring menuAlwaysOnTop;
+
+    // Menu - Help
+    std::wstring menuHelp;
+    std::wstring menuAbout;
+
+    // Menu - Language
+    std::wstring menuLanguage;
+    std::wstring menuLangEnglish;
+    std::wstring menuLangJapanese;
+
+    // Dialogs
+    std::wstring dialogFind;
+    std::wstring dialogFindReplace;
+    std::wstring dialogGoTo;
+    std::wstring dialogTransparency;
+    std::wstring dialogFindLabel;
+    std::wstring dialogReplaceLabel;
+    std::wstring dialogFindNext;
+    std::wstring dialogReplace;
+    std::wstring dialogReplaceAll;
+    std::wstring dialogClose;
+    std::wstring dialogLineNumber;
+    std::wstring dialogOK;
+    std::wstring dialogCancel;
+    std::wstring dialogOpacityLabel;
+
+    // Messages
+    std::wstring msgCannotFind;
+    std::wstring msgSaveChanges;
+    std::wstring msgCannotOpenFile;
+    std::wstring msgCannotSaveFile;
+    std::wstring msgError;
+    std::wstring msgAbout;
+
+    // Status bar
+    std::wstring statusLn;
+    std::wstring statusCol;
+
+    // Encoding names
+    std::wstring encodingUTF8;
+    std::wstring encodingUTF8BOM;
+    std::wstring encodingUTF16LE;
+    std::wstring encodingUTF16BE;
+    std::wstring encodingANSI;
+
+    // Line ending names
+    std::wstring lineEndingCRLF;
+    std::wstring lineEndingLF;
+    std::wstring lineEndingCR;
+};
+
+void InitLanguage();
+void SetLanguage(LangID lang);
+void SaveLanguageSetting();
+LangID LoadLanguageSetting();
+LangID GetCurrentLanguage();
+const LangStrings &GetLangStrings();
+const std::wstring &GetString(const std::wstring &key);
+
diff --git a/src/main.cpp b/src/main.cpp
index 8b0694f..dfb5495 100644
--- a/src/main.cpp
+++ b/src/main.cpp
@@ -46,6 +46,8 @@
 #include "modules/background.h"
 #include "modules/dialog.h"
 #include "modules/commands.h"
+#include "modules/menu.h"
+#include "lang/lang.h"
 
 LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
 {
@@ -68,6 +70,11 @@ LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
         SendMessageW(g_hwndEditor, EM_SETEVENTMASK, 0, mask | ENM_CHANGE);
         ApplyFont();
         SetupStatusBarParts();
+        UpdateMenuStrings();
+        UpdateLanguageMenu();
+        CheckMenuItem(GetMenu(g_hwndMain), IDM_VIEW_ALWAYSONTOP, g_state.alwaysOnTop ? MF_CHECKED : MF_UNCHECKED);
+        if (g_state.alwaysOnTop)
+            SetWindowPos(g_hwndMain, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE);
         UpdateTitle();
         UpdateStatus();
         ApplyTheme();
@@ -348,6 +355,9 @@ LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
         case IDM_VIEW_TRANSPARENCY:
             ViewTransparency();
             break;
+        case IDM_VIEW_ALWAYSONTOP:
+            ViewAlwaysOnTop();
+            break;
         case IDM_VIEW_BG_SELECT:
             ViewSelectBackground();
             break;
@@ -396,6 +406,30 @@ LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
         case IDM_VIEW_BG_POS_FILL:
             SetBackgroundPosition(BgPosition::Fill);
             break;
+        case IDM_VIEW_LANG_EN:
+            if (g_hwndFindDlg)
+            {
+                DestroyWindow(g_hwndFindDlg);
+                g_hwndFindDlg = nullptr;
+            }
+            SetLanguage(LangID::EN);
+            UpdateMenuStrings();
+            UpdateLanguageMenu();
+            UpdateTitle();
+            UpdateStatus();
+            break;
+        case IDM_VIEW_LANG_JA:
+            if (g_hwndFindDlg)
+            {
+                DestroyWindow(g_hwndFindDlg);
+                g_hwndFindDlg = nullptr;
+            }
+            SetLanguage(LangID::JA);
+            UpdateMenuStrings();
+            UpdateLanguageMenu();
+            UpdateTitle();
+            UpdateStatus();
+            break;
         case IDM_HELP_ABOUT:
             HelpAbout();
             break;
@@ -480,6 +514,7 @@ LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
 
 int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE, LPWSTR lpCmdLine, int nCmdShow)
 {
+    InitLanguage();
     SetProcessDpiAwarenessContext(DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2);
     HMODULE hUxtheme = LoadLibraryExW(L"uxtheme.dll", nullptr, LOAD_LIBRARY_SEARCH_SYSTEM32);
     if (hUxtheme)
@@ -523,7 +558,9 @@ int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE, LPWSTR lpCmdLine, int nCmdSh
     wc.lpszClassName = L"NotepadClass";
     wc.hIconSm = LoadIconW(hInstance, MAKEINTRESOURCEW(IDI_NOTEPAD));
     RegisterClassExW(&wc);
-    g_hwndMain = CreateWindowExW(0, L"NotepadClass", L"Untitled - Notepad",
+    const auto &lang = GetLangStrings();
+    std::wstring initialTitle = lang.untitled + L" - " + lang.appName;
+    g_hwndMain = CreateWindowExW(0, L"NotepadClass", initialTitle.c_str(),
                                  WS_OVERLAPPEDWINDOW | WS_MAXIMIZEBOX, CW_USEDEFAULT, CW_USEDEFAULT, 800, 600,
                                  nullptr, nullptr, hInstance, nullptr);
     g_hAccel = LoadAcceleratorsW(hInstance, MAKEINTRESOURCEW(IDR_ACCEL));
diff --git a/src/modules/commands.cpp b/src/modules/commands.cpp
index d5a1669..5cbe483 100644
--- a/src/modules/commands.cpp
+++ b/src/modules/commands.cpp
@@ -19,6 +19,7 @@
 #include "file.h"
 #include "ui.h"
 #include "resource.h"
+#include "lang/lang.h"
 #include <commdlg.h>
 #include <shlwapi.h>
 #include <vector>
@@ -27,9 +28,21 @@ bool ConfirmDiscard()
 {
     if (!g_state.modified)
         return true;
-    std::wstring filename = g_state.filePath.empty() ? L"Untitled" : PathFindFileNameW(g_state.filePath.c_str());
-    std::wstring msg = L"Do you want to save changes to " + filename + L"?";
-    int result = MessageBoxW(g_hwndMain, msg.c_str(), APP_NAME, MB_YESNOCANCEL | MB_ICONWARNING);
+    //  untitled and empty, don't ask to save
+    if (g_state.filePath.empty())
+    {
+        std::wstring text = GetEditorText();
+        if (text.empty())
+            return true;
+    }
+    const auto &lang = GetLangStrings();
+    std::wstring filename = g_state.filePath.empty() ? lang.untitled : PathFindFileNameW(g_state.filePath.c_str());
+    std::wstring msg;
+    msg.reserve(lang.msgSaveChanges.size() + filename.size() + 2);
+    msg = lang.msgSaveChanges;
+    msg += filename;
+    msg += L"?";
+    int result = MessageBoxW(g_hwndMain, msg.c_str(), lang.appName.c_str(), MB_YESNOCANCEL | MB_ICONWARNING);
     if (result == IDYES)
     {
         FileSave();
@@ -98,7 +111,8 @@ void FilePrint()
         return;
     HDC hDC = pd.hDC;
     DOCINFOW di = {sizeof(di)};
-    std::wstring docName = g_state.filePath.empty() ? L"Untitled" : PathFindFileNameW(g_state.filePath.c_str());
+    const auto &lang = GetLangStrings();
+    std::wstring docName = g_state.filePath.empty() ? lang.untitled : PathFindFileNameW(g_state.filePath.c_str());
     di.lpszDocName = docName.c_str();
     if (StartDocW(hDC, &di) > 0)
     {
@@ -228,3 +242,10 @@ void ViewStatusBar()
     ResizeControls();
     UpdateStatus();
 }
+
+void ViewAlwaysOnTop()
+{
+    g_state.alwaysOnTop = !g_state.alwaysOnTop;
+    CheckMenuItem(GetMenu(g_hwndMain), IDM_VIEW_ALWAYSONTOP, g_state.alwaysOnTop ? MF_CHECKED : MF_UNCHECKED);
+    SetWindowPos(g_hwndMain, g_state.alwaysOnTop ? HWND_TOPMOST : HWND_NOTOPMOST, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE);
+}
diff --git a/src/modules/commands.h b/src/modules/commands.h
index e7e59fb..fe439d4 100644
--- a/src/modules/commands.h
+++ b/src/modules/commands.h
@@ -38,3 +38,4 @@ void ViewZoomIn();
 void ViewZoomOut();
 void ViewZoomDefault();
 void ViewStatusBar();
+void ViewAlwaysOnTop();
diff --git a/src/modules/dialog.cpp b/src/modules/dialog.cpp
index 303a83a..51c2d68 100644
--- a/src/modules/dialog.cpp
+++ b/src/modules/dialog.cpp
@@ -17,6 +17,7 @@
 #include "core/globals.h"
 #include "editor.h"
 #include "ui.h"
+#include "lang/lang.h"
 #include <commdlg.h>
 #include <algorithm>
 #include <cwctype>
@@ -52,7 +53,10 @@ void DoFind(bool forward)
         SendMessageW(g_hwndEditor, EM_SCROLLCARET, 0, 0);
     }
     else
-        MessageBoxW(g_hwndMain, (L"Cannot find \"" + g_state.findText + L"\"").c_str(), APP_NAME, MB_ICONINFORMATION);
+    {
+        const auto &lang = GetLangStrings();
+        MessageBoxW(g_hwndMain, (lang.msgCannotFind + g_state.findText + L"\"").c_str(), lang.appName.c_str(), MB_ICONINFORMATION);
+    }
 }
 
 INT_PTR CALLBACK FindDlgProc(HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam)
@@ -120,6 +124,7 @@ INT_PTR CALLBACK FindDlgProc(HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam)
             std::wstring lower = text;
             std::transform(lower.begin(), lower.end(), lower.begin(), towlower);
             std::wstring newText;
+            newText.reserve(text.size() + (g_state.replaceText.size() - g_state.findText.size()) * 10);
             size_t lastPos = 0, pos = 0;
             while ((pos = lower.find(findLower, lastPos)) != std::wstring::npos)
             {
@@ -171,16 +176,17 @@ void EditFind()
         SetFocus(g_hwndFindDlg);
         return;
     }
-    g_hwndFindDlg = CreateWindowExW(WS_EX_DLGMODALFRAME, L"#32770", L"Find",
+    const auto &lang = GetLangStrings();
+    g_hwndFindDlg = CreateWindowExW(WS_EX_DLGMODALFRAME, L"#32770", lang.dialogFind.c_str(),
                                     WS_POPUP | WS_CAPTION | WS_SYSMENU | WS_VISIBLE, 100, 100, 420, 120,
                                     g_hwndMain, nullptr, GetModuleHandleW(nullptr), nullptr);
     if (g_hwndFindDlg)
     {
         HFONT hFont = reinterpret_cast<HFONT>(GetStockObject(DEFAULT_GUI_FONT));
-        CreateWindowExW(0, L"STATIC", L"Find:", WS_CHILD | WS_VISIBLE, 10, 12, 45, 16, g_hwndFindDlg, nullptr, nullptr, nullptr);
+        CreateWindowExW(0, L"STATIC", lang.dialogFindLabel.c_str(), WS_CHILD | WS_VISIBLE, 10, 12, 45, 16, g_hwndFindDlg, nullptr, nullptr, nullptr);
         CreateWindowExW(WS_EX_CLIENTEDGE, L"EDIT", g_state.findText.c_str(), WS_CHILD | WS_VISIBLE | ES_AUTOHSCROLL, 60, 10, 230, 20, g_hwndFindDlg, reinterpret_cast<HMENU>(1001), nullptr, nullptr);
-        CreateWindowExW(0, L"BUTTON", L"Find Next", WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 300, 10, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(1), nullptr, nullptr);
-        CreateWindowExW(0, L"BUTTON", L"Close", WS_CHILD | WS_VISIBLE, 300, 38, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(2), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogFindNext.c_str(), WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 300, 10, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(1), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogClose.c_str(), WS_CHILD | WS_VISIBLE, 300, 38, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(2), nullptr, nullptr);
         for (HWND h = GetWindow(g_hwndFindDlg, GW_CHILD); h; h = GetWindow(h, GW_HWNDNEXT))
             SendMessageW(h, WM_SETFONT, reinterpret_cast<WPARAM>(hFont), TRUE);
         SetWindowLongPtrW(g_hwndFindDlg, GWLP_WNDPROC, reinterpret_cast<LONG_PTR>(FindDlgProc));
@@ -208,20 +214,21 @@ void EditReplace()
         SetFocus(g_hwndFindDlg);
         return;
     }
-    g_hwndFindDlg = CreateWindowExW(WS_EX_DLGMODALFRAME, L"#32770", L"Find and Replace",
+    const auto &lang = GetLangStrings();
+    g_hwndFindDlg = CreateWindowExW(WS_EX_DLGMODALFRAME, L"#32770", lang.dialogFindReplace.c_str(),
                                     WS_POPUP | WS_CAPTION | WS_SYSMENU | WS_VISIBLE, 100, 100, 420, 175,
                                     g_hwndMain, nullptr, GetModuleHandleW(nullptr), nullptr);
     if (g_hwndFindDlg)
     {
         HFONT hFont = reinterpret_cast<HFONT>(GetStockObject(DEFAULT_GUI_FONT));
-        CreateWindowExW(0, L"STATIC", L"Find:", WS_CHILD | WS_VISIBLE, 10, 12, 45, 16, g_hwndFindDlg, nullptr, nullptr, nullptr);
+        CreateWindowExW(0, L"STATIC", lang.dialogFindLabel.c_str(), WS_CHILD | WS_VISIBLE, 10, 12, 45, 16, g_hwndFindDlg, nullptr, nullptr, nullptr);
         CreateWindowExW(WS_EX_CLIENTEDGE, L"EDIT", g_state.findText.c_str(), WS_CHILD | WS_VISIBLE | ES_AUTOHSCROLL, 60, 10, 230, 20, g_hwndFindDlg, reinterpret_cast<HMENU>(1001), nullptr, nullptr);
-        CreateWindowExW(0, L"STATIC", L"Replace:", WS_CHILD | WS_VISIBLE, 10, 40, 50, 16, g_hwndFindDlg, nullptr, nullptr, nullptr);
+        CreateWindowExW(0, L"STATIC", lang.dialogReplaceLabel.c_str(), WS_CHILD | WS_VISIBLE, 10, 40, 50, 16, g_hwndFindDlg, nullptr, nullptr, nullptr);
         CreateWindowExW(WS_EX_CLIENTEDGE, L"EDIT", g_state.replaceText.c_str(), WS_CHILD | WS_VISIBLE | ES_AUTOHSCROLL, 60, 38, 230, 20, g_hwndFindDlg, reinterpret_cast<HMENU>(1002), nullptr, nullptr);
-        CreateWindowExW(0, L"BUTTON", L"Find Next", WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 300, 10, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(1), nullptr, nullptr);
-        CreateWindowExW(0, L"BUTTON", L"Replace", WS_CHILD | WS_VISIBLE, 300, 38, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(3), nullptr, nullptr);
-        CreateWindowExW(0, L"BUTTON", L"Replace All", WS_CHILD | WS_VISIBLE, 300, 66, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(4), nullptr, nullptr);
-        CreateWindowExW(0, L"BUTTON", L"Close", WS_CHILD | WS_VISIBLE, 300, 94, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(2), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogFindNext.c_str(), WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 300, 10, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(1), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogReplace.c_str(), WS_CHILD | WS_VISIBLE, 300, 38, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(3), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogReplaceAll.c_str(), WS_CHILD | WS_VISIBLE, 300, 66, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(4), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogClose.c_str(), WS_CHILD | WS_VISIBLE, 300, 94, 100, 22, g_hwndFindDlg, reinterpret_cast<HMENU>(2), nullptr, nullptr);
         for (HWND h = GetWindow(g_hwndFindDlg, GW_CHILD); h; h = GetWindow(h, GW_HWNDNEXT))
             SendMessageW(h, WM_SETFONT, reinterpret_cast<WPARAM>(hFont), TRUE);
         SetWindowLongPtrW(g_hwndFindDlg, GWLP_WNDPROC, reinterpret_cast<LONG_PTR>(FindDlgProc));
@@ -230,27 +237,28 @@ void EditReplace()
     }
 }
 
-void EditGoto()
+INT_PTR CALLBACK GotoDlgProc(HWND hDlg, UINT msg, WPARAM wParam, LPARAM)
 {
-    (void)DialogBoxW(nullptr, nullptr, g_hwndMain, [](HWND hDlg, UINT msg, WPARAM wParam, LPARAM) -> INT_PTR
-                     {
-        static HWND hEdit = nullptr;
-        switch (msg)
+    static HWND hEdit = nullptr;
+    switch (msg)
+    {
+    case WM_INITDIALOG:
+    {
+        const auto &lang = GetLangStrings();
+        SetWindowTextW(hDlg, lang.dialogGoTo.c_str());
+        hEdit = CreateWindowExW(WS_EX_CLIENTEDGE, L"EDIT", L"1", WS_CHILD | WS_VISIBLE | ES_NUMBER, 80, 15, 120, 22, hDlg, reinterpret_cast<HMENU>(1001), nullptr, nullptr);
+        CreateWindowExW(0, L"STATIC", lang.dialogLineNumber.c_str(), WS_CHILD | WS_VISIBLE, 10, 18, 70, 20, hDlg, nullptr, nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogOK.c_str(), WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 60, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDOK), nullptr, nullptr);
+        CreateWindowExW(0, L"BUTTON", lang.dialogCancel.c_str(), WS_CHILD | WS_VISIBLE, 140, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDCANCEL), nullptr, nullptr);
         {
-        case WM_INITDIALOG:
-            SetWindowTextW(hDlg, L"Go To Line");
-            hEdit = CreateWindowExW(WS_EX_CLIENTEDGE, L"EDIT", L"1", WS_CHILD | WS_VISIBLE | ES_NUMBER, 80, 15, 120, 22, hDlg, reinterpret_cast<HMENU>(1001), nullptr, nullptr);
-            CreateWindowExW(0, L"STATIC", L"Line number:", WS_CHILD | WS_VISIBLE, 10, 18, 70, 20, hDlg, nullptr, nullptr, nullptr);
-            CreateWindowExW(0, L"BUTTON", L"OK", WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 60, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDOK), nullptr, nullptr);
-            CreateWindowExW(0, L"BUTTON", L"Cancel", WS_CHILD | WS_VISIBLE, 140, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDCANCEL), nullptr, nullptr);
-            {
-                HFONT hFont = reinterpret_cast<HFONT>(GetStockObject(DEFAULT_GUI_FONT));
-                for (HWND h = GetWindow(hDlg, GW_CHILD); h; h = GetWindow(h, GW_HWNDNEXT))
-                    SendMessageW(h, WM_SETFONT, reinterpret_cast<WPARAM>(hFont), TRUE);
-            }
-            SetFocus(hEdit);
-            return FALSE;
-        case WM_COMMAND:
+            HFONT hFont = reinterpret_cast<HFONT>(GetStockObject(DEFAULT_GUI_FONT));
+            for (HWND h = GetWindow(hDlg, GW_CHILD); h; h = GetWindow(h, GW_HWNDNEXT))
+                SendMessageW(h, WM_SETFONT, reinterpret_cast<WPARAM>(hFont), TRUE);
+        }
+        SetFocus(hEdit);
+        return FALSE;
+    }
+    case WM_COMMAND:
             if (LOWORD(wParam) == IDOK)
             {
                 wchar_t buf[32];
@@ -273,11 +281,16 @@ void EditGoto()
             }
             else if (LOWORD(wParam) == IDCANCEL) { EndDialog(hDlg, IDCANCEL); return TRUE; }
             break;
-        case WM_CLOSE:
-            EndDialog(hDlg, IDCANCEL);
-            return TRUE;
-        }
-        return FALSE; });
+    case WM_CLOSE:
+        EndDialog(hDlg, IDCANCEL);
+        return TRUE;
+    }
+    return FALSE;
+}
+
+void EditGoto()
+{
+    DialogBoxW(nullptr, nullptr, g_hwndMain, GotoDlgProc);
 }
 
 void FormatFont()
@@ -315,19 +328,20 @@ void FormatFont()
 
 void ViewTransparency()
 {
+    const auto &lang = GetLangStrings();
     int pct = g_state.windowOpacity * 100 / 255;
     wchar_t buf[32];
     wsprintfW(buf, L"%d", pct);
-    HWND hDlg = CreateWindowExW(WS_EX_DLGMODALFRAME, L"#32770", L"Window Transparency",
+    HWND hDlg = CreateWindowExW(WS_EX_DLGMODALFRAME, L"#32770", lang.dialogTransparency.c_str(),
                                 WS_POPUP | WS_CAPTION | WS_SYSMENU | WS_VISIBLE, 300, 300, 280, 110,
                                 g_hwndMain, nullptr, GetModuleHandleW(nullptr), nullptr);
     if (hDlg)
     {
         HFONT hFont = reinterpret_cast<HFONT>(GetStockObject(DEFAULT_GUI_FONT));
-        CreateWindowExW(0, L"STATIC", L"Opacity (10-100%):", WS_CHILD | WS_VISIBLE, 10, 18, 110, 20, hDlg, nullptr, nullptr, nullptr);
+        CreateWindowExW(0, L"STATIC", lang.dialogOpacityLabel.c_str(), WS_CHILD | WS_VISIBLE, 10, 18, 110, 20, hDlg, nullptr, nullptr, nullptr);
         HWND hEdit = CreateWindowExW(WS_EX_CLIENTEDGE, L"EDIT", buf, WS_CHILD | WS_VISIBLE | ES_NUMBER, 125, 15, 60, 22, hDlg, reinterpret_cast<HMENU>(1001), nullptr, nullptr);
-        HWND hOk = CreateWindowExW(0, L"BUTTON", L"OK", WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 50, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDOK), nullptr, nullptr);
-        HWND hCancel = CreateWindowExW(0, L"BUTTON", L"Cancel", WS_CHILD | WS_VISIBLE, 130, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDCANCEL), nullptr, nullptr);
+        HWND hOk = CreateWindowExW(0, L"BUTTON", lang.dialogOK.c_str(), WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON, 50, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDOK), nullptr, nullptr);
+        HWND hCancel = CreateWindowExW(0, L"BUTTON", lang.dialogCancel.c_str(), WS_CHILD | WS_VISIBLE, 130, 50, 70, 26, hDlg, reinterpret_cast<HMENU>(IDCANCEL), nullptr, nullptr);
         for (HWND h = GetWindow(hDlg, GW_CHILD); h; h = GetWindow(h, GW_HWNDNEXT))
             SendMessageW(h, WM_SETFONT, reinterpret_cast<WPARAM>(hFont), TRUE);
         MSG msg;
@@ -360,5 +374,6 @@ void ViewTransparency()
 
 void HelpAbout()
 {
-    MessageBoxW(g_hwndMain, L"Legacy Notepad v1.1.0\n\nA fast, lightweight text editor.\n\nBuilt with C++ and Win32 API.", L"About Notepad", MB_ICONINFORMATION);
+    const auto &lang = GetLangStrings();
+    MessageBoxW(g_hwndMain, lang.msgAbout.c_str(), lang.menuAbout.c_str(), MB_ICONINFORMATION);
 }
diff --git a/src/modules/editor.cpp b/src/modules/editor.cpp
index 38ab039..5fefa7a 100644
--- a/src/modules/editor.cpp
+++ b/src/modules/editor.cpp
@@ -38,23 +38,12 @@ void SetEditorText(const std::wstring &text)
 
 std::pair<int, int> GetCursorPos()
 {
-    std::wstring text = GetEditorText();
     DWORD start = 0, end = 0;
     SendMessageW(g_hwndEditor, EM_GETSEL, reinterpret_cast<WPARAM>(&start), reinterpret_cast<LPARAM>(&end));
     int pos = static_cast<int>(start);
-    int line = 1, col = 1;
-    for (int i = 0; i < pos && i < static_cast<int>(text.size()); ++i)
-    {
-        if (text[i] == L'\n')
-        {
-            ++line;
-            col = 1;
-        }
-        else if (text[i] != L'\r')
-        {
-            ++col;
-        }
-    }
+    int line = static_cast<int>(SendMessageW(g_hwndEditor, EM_LINEFROMCHAR, pos, 0)) + 1;
+    int lineStart = static_cast<int>(SendMessageW(g_hwndEditor, EM_LINEINDEX, line - 1, 0));
+    int col = pos - lineStart + 1;
     return {line, col};
 }
 
diff --git a/src/modules/file.cpp b/src/modules/file.cpp
index 55d031f..8a4c07b 100644
--- a/src/modules/file.cpp
+++ b/src/modules/file.cpp
@@ -12,43 +12,45 @@
   File I/O operations with multi-encoding support (UTF-8, UTF-16, ANSI).
   Handles BOM detection, line ending conversion, and recent files tracking.
 */
-
 #include "file.h"
 #include "core/globals.h"
 #include "editor.h"
 #include "ui.h"
 #include "resource.h"
+#include "lang/lang.h"
 #include <shlwapi.h>
 #include <algorithm>
 
 const wchar_t *GetEncodingName(Encoding e)
 {
+    const auto &lang = GetLangStrings();
     switch (e)
     {
     case Encoding::UTF8:
-        return L"UTF-8";
+        return lang.encodingUTF8.c_str();
     case Encoding::UTF8BOM:
-        return L"UTF-8 with BOM";
+        return lang.encodingUTF8BOM.c_str();
     case Encoding::UTF16LE:
-        return L"UTF-16 LE";
+        return lang.encodingUTF16LE.c_str();
     case Encoding::UTF16BE:
-        return L"UTF-16 BE";
+        return lang.encodingUTF16BE.c_str();
     case Encoding::ANSI:
-        return L"ANSI";
+        return lang.encodingANSI.c_str();
     }
     return L"";
 }
 
 const wchar_t *GetLineEndingName(LineEnding le)
 {
+    const auto &lang = GetLangStrings();
     switch (le)
     {
     case LineEnding::CRLF:
-        return L"Windows (CRLF)";
+        return lang.lineEndingCRLF.c_str();
     case LineEnding::LF:
-        return L"Unix (LF)";
+        return lang.lineEndingLF.c_str();
     case LineEnding::CR:
-        return L"Macintosh (CR)";
+        return lang.lineEndingCR.c_str();
     }
     return L"";
 }
@@ -131,7 +133,7 @@ std::wstring DecodeText(const std::vector<BYTE> &data, Encoding enc)
 std::vector<BYTE> EncodeText(const std::wstring &text, Encoding enc, LineEnding le)
 {
     std::wstring converted;
-    converted.reserve(text.size() * 2);
+    converted.reserve(text.size() + text.size() / 10);
     for (size_t i = 0; i < text.size(); ++i)
     {
         wchar_t c = text[i];
@@ -178,6 +180,7 @@ std::vector<BYTE> EncodeText(const std::wstring &text, Encoding enc, LineEnding
     case Encoding::UTF16LE:
         result.push_back(0xFF);
         result.push_back(0xFE);
+        result.reserve(result.size() + converted.size() * 2);
         for (wchar_t c : converted)
         {
             result.push_back(static_cast<BYTE>(c & 0xFF));
@@ -187,6 +190,7 @@ std::vector<BYTE> EncodeText(const std::wstring &text, Encoding enc, LineEnding
     case Encoding::UTF16BE:
         result.push_back(0xFE);
         result.push_back(0xFF);
+        result.reserve(result.size() + converted.size() * 2);
         for (wchar_t c : converted)
         {
             result.push_back(static_cast<BYTE>((c >> 8) & 0xFF));
@@ -214,7 +218,8 @@ void LoadFile(const std::wstring &path)
                                OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, nullptr);
     if (hFile == INVALID_HANDLE_VALUE)
     {
-        MessageBoxW(g_hwndMain, L"Cannot open file.", L"Error", MB_ICONERROR);
+        const auto &lang = GetLangStrings();
+        MessageBoxW(g_hwndMain, lang.msgCannotOpenFile.c_str(), lang.msgError.c_str(), MB_ICONERROR);
         return;
     }
     DWORD size = GetFileSize(hFile, nullptr);
@@ -242,7 +247,8 @@ void SaveToPath(const std::wstring &path)
                                CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, nullptr);
     if (hFile == INVALID_HANDLE_VALUE)
     {
-        MessageBoxW(g_hwndMain, L"Cannot save file.", L"Error", MB_ICONERROR);
+        const auto &lang = GetLangStrings();
+        MessageBoxW(g_hwndMain, lang.msgCannotSaveFile.c_str(), lang.msgError.c_str(), MB_ICONERROR);
         return;
     }
     DWORD written = 0;
@@ -293,5 +299,6 @@ void UpdateRecentFilesMenu()
         std::wstring display = PathFindFileNameW(file.c_str());
         AppendMenuW(hRecentMenu, MF_STRING, id++, display.c_str());
     }
-    InsertMenuW(hFileMenu, 5, MF_BYPOSITION | MF_POPUP, reinterpret_cast<UINT_PTR>(hRecentMenu), L"Recent Files");
+    const auto &lang = GetLangStrings();
+    InsertMenuW(hFileMenu, 5, MF_BYPOSITION | MF_POPUP, reinterpret_cast<UINT_PTR>(hRecentMenu), lang.menuRecentFiles.c_str());
 }
diff --git a/src/modules/menu.cpp b/src/modules/menu.cpp
new file mode 100644
index 0000000..c89b614
--- /dev/null
+++ b/src/modules/menu.cpp
@@ -0,0 +1,133 @@
+#include "menu.h"
+#include "core/globals.h"
+#include "resource.h"
+#include "lang/lang.h"
+
+void UpdateMenuStrings()
+{
+    HMENU hMenu = GetMenu(g_hwndMain);
+    if (!hMenu)
+        return;
+
+    const auto &lang = GetLangStrings();
+
+    ModifyMenuW(hMenu, 0, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(GetSubMenu(hMenu, 0)), lang.menuFile.c_str());
+    ModifyMenuW(hMenu, 1, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(GetSubMenu(hMenu, 1)), lang.menuEdit.c_str());
+    ModifyMenuW(hMenu, 2, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(GetSubMenu(hMenu, 2)), lang.menuFormat.c_str());
+    ModifyMenuW(hMenu, 3, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(GetSubMenu(hMenu, 3)), lang.menuView.c_str());
+    ModifyMenuW(hMenu, 4, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(GetSubMenu(hMenu, 4)), lang.menuHelp.c_str());
+
+    HMENU hFileMenu = GetSubMenu(hMenu, 0);
+    if (hFileMenu)
+    {
+        ModifyMenuW(hFileMenu, 0, MF_BYPOSITION | MF_STRING, IDM_FILE_NEW, lang.menuNew.c_str());
+        ModifyMenuW(hFileMenu, 1, MF_BYPOSITION | MF_STRING, IDM_FILE_OPEN, lang.menuOpen.c_str());
+        ModifyMenuW(hFileMenu, 2, MF_BYPOSITION | MF_STRING, IDM_FILE_SAVE, lang.menuSave.c_str());
+        ModifyMenuW(hFileMenu, 3, MF_BYPOSITION | MF_STRING, IDM_FILE_SAVEAS, lang.menuSaveAs.c_str());
+        ModifyMenuW(hFileMenu, 5, MF_BYPOSITION | MF_STRING, IDM_FILE_PRINT, lang.menuPrint.c_str());
+        ModifyMenuW(hFileMenu, 6, MF_BYPOSITION | MF_STRING, IDM_FILE_PAGESETUP, lang.menuPageSetup.c_str());
+        ModifyMenuW(hFileMenu, 8, MF_BYPOSITION | MF_STRING, IDM_FILE_EXIT, lang.menuExit.c_str());
+    }
+
+    HMENU hEditMenu = GetSubMenu(hMenu, 1);
+    if (hEditMenu)
+    {
+        ModifyMenuW(hEditMenu, 0, MF_BYPOSITION | MF_STRING, IDM_EDIT_UNDO, lang.menuUndo.c_str());
+        ModifyMenuW(hEditMenu, 1, MF_BYPOSITION | MF_STRING, IDM_EDIT_REDO, lang.menuRedo.c_str());
+        ModifyMenuW(hEditMenu, 3, MF_BYPOSITION | MF_STRING, IDM_EDIT_CUT, lang.menuCut.c_str());
+        ModifyMenuW(hEditMenu, 4, MF_BYPOSITION | MF_STRING, IDM_EDIT_COPY, lang.menuCopy.c_str());
+        ModifyMenuW(hEditMenu, 5, MF_BYPOSITION | MF_STRING, IDM_EDIT_PASTE, lang.menuPaste.c_str());
+        ModifyMenuW(hEditMenu, 6, MF_BYPOSITION | MF_STRING, IDM_EDIT_DELETE, lang.menuDelete.c_str());
+        ModifyMenuW(hEditMenu, 8, MF_BYPOSITION | MF_STRING, IDM_EDIT_FIND, lang.menuFind.c_str());
+        ModifyMenuW(hEditMenu, 9, MF_BYPOSITION | MF_STRING, IDM_EDIT_FINDNEXT, lang.menuFindNext.c_str());
+        ModifyMenuW(hEditMenu, 10, MF_BYPOSITION | MF_STRING, IDM_EDIT_FINDPREV, lang.menuFindPrev.c_str());
+        ModifyMenuW(hEditMenu, 11, MF_BYPOSITION | MF_STRING, IDM_EDIT_REPLACE, lang.menuReplace.c_str());
+        ModifyMenuW(hEditMenu, 12, MF_BYPOSITION | MF_STRING, IDM_EDIT_GOTO, lang.menuGoTo.c_str());
+        ModifyMenuW(hEditMenu, 14, MF_BYPOSITION | MF_STRING, IDM_EDIT_SELECTALL, lang.menuSelectAll.c_str());
+        ModifyMenuW(hEditMenu, 15, MF_BYPOSITION | MF_STRING, IDM_EDIT_TIMEDATE, lang.menuTimeDate.c_str());
+    }
+
+    HMENU hFormatMenu = GetSubMenu(hMenu, 2);
+    if (hFormatMenu)
+    {
+        ModifyMenuW(hFormatMenu, 0, MF_BYPOSITION | MF_STRING, IDM_FORMAT_WORDWRAP, lang.menuWordWrap.c_str());
+        ModifyMenuW(hFormatMenu, 1, MF_BYPOSITION | MF_STRING, IDM_FORMAT_FONT, lang.menuFont.c_str());
+    }
+
+    HMENU hViewMenu = GetSubMenu(hMenu, 3);
+    if (hViewMenu)
+    {
+        ModifyMenuW(hViewMenu, 0, MF_BYPOSITION | MF_STRING, IDM_VIEW_ZOOMIN, lang.menuZoomIn.c_str());
+        ModifyMenuW(hViewMenu, 1, MF_BYPOSITION | MF_STRING, IDM_VIEW_ZOOMOUT, lang.menuZoomOut.c_str());
+        ModifyMenuW(hViewMenu, 2, MF_BYPOSITION | MF_STRING, IDM_VIEW_ZOOMDEFAULT, lang.menuZoomDefault.c_str());
+        ModifyMenuW(hViewMenu, 4, MF_BYPOSITION | MF_STRING, IDM_VIEW_STATUSBAR, lang.menuStatusBar.c_str());
+        ModifyMenuW(hViewMenu, 5, MF_BYPOSITION | MF_STRING, IDM_VIEW_DARKMODE, lang.menuDarkMode.c_str());
+
+        HMENU hBgMenu = GetSubMenu(hViewMenu, 7);
+        if (hBgMenu)
+        {
+            ModifyMenuW(hViewMenu, 7, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(hBgMenu), lang.menuBackground.c_str());
+            ModifyMenuW(hBgMenu, 0, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_SELECT, lang.menuBgSelect.c_str());
+            ModifyMenuW(hBgMenu, 1, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_CLEAR, lang.menuBgClear.c_str());
+            ModifyMenuW(hBgMenu, 2, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_OPACITY, lang.menuBgOpacity.c_str());
+
+            HMENU hPosMenu = GetSubMenu(hBgMenu, 4);
+            if (hPosMenu)
+            {
+                ModifyMenuW(hBgMenu, 4, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(hPosMenu), lang.menuBgPosition.c_str());
+                ModifyMenuW(hPosMenu, 0, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_TOPLEFT, lang.menuBgPosTopLeft.c_str());
+                ModifyMenuW(hPosMenu, 1, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_TOPCENTER, lang.menuBgPosTopCenter.c_str());
+                ModifyMenuW(hPosMenu, 2, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_TOPRIGHT, lang.menuBgPosTopRight.c_str());
+                ModifyMenuW(hPosMenu, 4, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_CENTERLEFT, lang.menuBgPosCenterLeft.c_str());
+                ModifyMenuW(hPosMenu, 5, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_CENTER, lang.menuBgPosCenter.c_str());
+                ModifyMenuW(hPosMenu, 6, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_CENTERRIGHT, lang.menuBgPosCenterRight.c_str());
+                ModifyMenuW(hPosMenu, 8, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_BOTTOMLEFT, lang.menuBgPosBottomLeft.c_str());
+                ModifyMenuW(hPosMenu, 9, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_BOTTOMCENTER, lang.menuBgPosBottomCenter.c_str());
+                ModifyMenuW(hPosMenu, 10, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_BOTTOMRIGHT, lang.menuBgPosBottomRight.c_str());
+                ModifyMenuW(hPosMenu, 12, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_TILE, lang.menuBgPosTile.c_str());
+                ModifyMenuW(hPosMenu, 13, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_STRETCH, lang.menuBgPosStretch.c_str());
+                ModifyMenuW(hPosMenu, 14, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_FIT, lang.menuBgPosFit.c_str());
+                ModifyMenuW(hPosMenu, 15, MF_BYPOSITION | MF_STRING, IDM_VIEW_BG_POS_FILL, lang.menuBgPosFill.c_str());
+            }
+        }
+
+        ModifyMenuW(hViewMenu, 9, MF_BYPOSITION | MF_STRING, IDM_VIEW_TRANSPARENCY, lang.menuTransparency.c_str());
+        ModifyMenuW(hViewMenu, 10, MF_BYPOSITION | MF_STRING, IDM_VIEW_ALWAYSONTOP, lang.menuAlwaysOnTop.c_str());
+        
+        HMENU hLangMenu = GetSubMenu(hViewMenu, 12);
+        if (hLangMenu)
+        {
+            ModifyMenuW(hViewMenu, 12, MF_BYPOSITION | MF_STRING | MF_POPUP, reinterpret_cast<UINT_PTR>(hLangMenu), lang.menuLanguage.c_str());
+            ModifyMenuW(hLangMenu, 0, MF_BYPOSITION | MF_STRING, IDM_VIEW_LANG_EN, lang.menuLangEnglish.c_str());
+            ModifyMenuW(hLangMenu, 1, MF_BYPOSITION | MF_STRING, IDM_VIEW_LANG_JA, lang.menuLangJapanese.c_str());
+        }
+    }
+
+    HMENU hHelpMenu = GetSubMenu(hMenu, 4);
+    if (hHelpMenu)
+    {
+        ModifyMenuW(hHelpMenu, 0, MF_BYPOSITION | MF_STRING, IDM_HELP_ABOUT, lang.menuAbout.c_str());
+    }
+
+    DrawMenuBar(g_hwndMain);
+}
+
+void UpdateLanguageMenu()
+{
+    HMENU hMenu = GetMenu(g_hwndMain);
+    if (!hMenu)
+        return;
+
+    HMENU hViewMenu = GetSubMenu(hMenu, 3);
+    if (!hViewMenu)
+        return;
+
+    HMENU hLangMenu = GetSubMenu(hViewMenu, 12);
+    if (!hLangMenu)
+        return;
+
+    LangID currentLang = GetCurrentLanguage();
+    CheckMenuItem(hLangMenu, IDM_VIEW_LANG_EN, (currentLang == LangID::EN) ? MF_CHECKED : MF_UNCHECKED);
+    CheckMenuItem(hLangMenu, IDM_VIEW_LANG_JA, (currentLang == LangID::JA) ? MF_CHECKED : MF_UNCHECKED);
+}
+
diff --git a/src/modules/menu.h b/src/modules/menu.h
new file mode 100644
index 0000000..3988813
--- /dev/null
+++ b/src/modules/menu.h
@@ -0,0 +1,7 @@
+#pragma once
+
+#include <windows.h>
+
+void UpdateMenuStrings();
+void UpdateLanguageMenu();
+
diff --git a/src/modules/ui.cpp b/src/modules/ui.cpp
index ad573d0..68cc42e 100644
--- a/src/modules/ui.cpp
+++ b/src/modules/ui.cpp
@@ -17,13 +17,21 @@
 #include "core/globals.h"
 #include "editor.h"
 #include "file.h"
+#include "lang/lang.h"
 #include <commctrl.h>
 #include <shlwapi.h>
 
 void UpdateTitle()
 {
-    std::wstring filename = g_state.filePath.empty() ? L"Untitled" : PathFindFileNameW(g_state.filePath.c_str());
-    std::wstring title = (g_state.modified ? L"*" : L"") + filename + L" - " + APP_NAME;
+    const auto &lang = GetLangStrings();
+    std::wstring filename = g_state.filePath.empty() ? lang.untitled : PathFindFileNameW(g_state.filePath.c_str());
+    std::wstring title;
+    title.reserve(filename.size() + lang.appName.size() + 10);
+    if (g_state.modified)
+        title += L"*";
+    title += filename;
+    title += L" - ";
+    title += lang.appName;
     SetWindowTextW(g_hwndMain, title.c_str());
 }
 
@@ -35,9 +43,10 @@ void UpdateStatus()
         return;
     }
     ShowWindow(g_hwndStatus, SW_SHOW);
+    const auto &lang = GetLangStrings();
     auto [line, col] = GetCursorPos();
     wchar_t buf[256];
-    wsprintfW(buf, L" Ln %d, Col %d ", line, col);
+    wsprintfW(buf, (lang.statusLn + L"%d" + lang.statusCol + L"%d ").c_str(), line, col);
     g_statusTexts[0] = buf;
     g_statusTexts[1] = GetEncodingName(g_state.encoding);
     g_statusTexts[2] = GetLineEndingName(g_state.lineEnding);
diff --git a/src/notepad.rc b/src/notepad.rc
index 289a9b4..f9721fc 100644
--- a/src/notepad.rc
+++ b/src/notepad.rc
@@ -78,6 +78,13 @@ BEGIN
         END
         MENUITEM SEPARATOR
         MENUITEM "Window &Transparency...", IDM_VIEW_TRANSPARENCY
+        MENUITEM "Always on &Top", IDM_VIEW_ALWAYSONTOP
+        MENUITEM SEPARATOR
+        POPUP "&Language"
+        BEGIN
+            MENUITEM "&English", IDM_VIEW_LANG_EN
+            MENUITEM "&Japanese", IDM_VIEW_LANG_JA
+        END
     END
     POPUP "&Help"
     BEGIN
diff --git a/src/resource.h b/src/resource.h
index 65c1ef0..2225675 100644
--- a/src/resource.h
+++ b/src/resource.h
@@ -54,6 +54,7 @@
 #define IDM_VIEW_STATUSBAR 40043
 #define IDM_VIEW_DARKMODE 40044
 #define IDM_VIEW_TRANSPARENCY 40045
+#define IDM_VIEW_ALWAYSONTOP 40046
 
 #define IDM_VIEW_BG_SELECT 40050
 #define IDM_VIEW_BG_CLEAR 40051
@@ -73,3 +74,7 @@
 #define IDM_VIEW_BG_POS_FILL 40072
 
 #define IDM_HELP_ABOUT 40080
+
+#define IDM_VIEW_LANGUAGE 40090
+#define IDM_VIEW_LANG_EN 40091
+#define IDM_VIEW_LANG_JA 40092

From 9a2236597c7f4e2262c9038062932790c87fb516 Mon Sep 17 00:00:00 2001
From: nananankona <konana.net@proton.me>
Date: Sun, 1 Feb 2026 00:34:15 +0900
Subject: [PATCH 2/3] Update README with new features and improvements

Added new features including window pinning, language support, and improved empty file saving behavior.
---
 README.md | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/README.md b/README.md
index 0ecf364..0b1a194 100644
--- a/README.md
+++ b/README.md
@@ -1,8 +1,12 @@
+[![Build and Release](https://github.com/nananankona/legacy-notepad-add-lang/actions/workflows/build.yml/badge.svg)](https://github.com/nananankona/legacy-notepad-add-lang/actions/workflows/build.yml)
+
 # Legacy Notepad
 
 A lightweight, 25x fast, Windows notepad alternative built with C++17 and Win32 API which I made because microsoft wont stop adding AI bloatware to notepad.exe.
 
-<img width="752" height="242" alt="image" src="https://github.com/user-attachments/assets/bca18796-b088-4488-a445-649a549ddace" />
+<img width="797" height="595" alt="image" src="https://github.com/user-attachments/assets/c29c1cf5-1b4f-4638-b9f0-4fb6d0d7ac0e" />
+
+<img width="743" height="101" alt="image" src="https://github.com/user-attachments/assets/3c771eba-5570-4ead-ba49-73666b00f051" />
 <img width="738" height="243" alt="image" src="https://github.com/user-attachments/assets/e9ba9361-d1ea-41ee-a18d-f38fb9bdb546" />
 
 ## Features
@@ -12,6 +16,12 @@ A lightweight, 25x fast, Windows notepad alternative built with C++17 and Win32
 - **Backgrounds**: optional image with tile/stretch/fit/fill/anchor modes and opacity control. (known issues)
 - **Printing**: print and page setup dialogs.
 
+## Added Features
+
+- **Pin Window**: Pins the Notepad window to the front.
+- **Language Support**: Added new languages.
+- **Don't Prompt if Empty**: Does not display a confirmation message when saving an empty file without a title.
+
 ## Requirements
 
 - Windows 10/11 with Win32 and GDI+ (desktop apps)

From 9d6ab507c0343471c289f8774aabbc13997144fc Mon Sep 17 00:00:00 2001
From: yukkuriremiria <konana.net@proton.me>
Date: Sun, 1 Feb 2026 03:07:54 +0900
Subject: [PATCH 3/3] ate

---
 README.md     | 14 ++------------
 src/lang/en.h |  2 +-
 src/lang/ja.h |  2 +-
 3 files changed, 4 insertions(+), 14 deletions(-)

diff --git a/README.md b/README.md
index 0b1a194..21a7956 100644
--- a/README.md
+++ b/README.md
@@ -1,12 +1,8 @@
-[![Build and Release](https://github.com/nananankona/legacy-notepad-add-lang/actions/workflows/build.yml/badge.svg)](https://github.com/nananankona/legacy-notepad-add-lang/actions/workflows/build.yml)
-
 # Legacy Notepad
 
 A lightweight, 25x fast, Windows notepad alternative built with C++17 and Win32 API which I made because microsoft wont stop adding AI bloatware to notepad.exe.
 
-<img width="797" height="595" alt="image" src="https://github.com/user-attachments/assets/c29c1cf5-1b4f-4638-b9f0-4fb6d0d7ac0e" />
-
-<img width="743" height="101" alt="image" src="https://github.com/user-attachments/assets/3c771eba-5570-4ead-ba49-73666b00f051" />
+<img width="752" height="242" alt="image" src="https://github.com/user-attachments/assets/bca18796-b088-4488-a445-649a549ddace" />
 <img width="738" height="243" alt="image" src="https://github.com/user-attachments/assets/e9ba9361-d1ea-41ee-a18d-f38fb9bdb546" />
 
 ## Features
@@ -16,12 +12,6 @@ A lightweight, 25x fast, Windows notepad alternative built with C++17 and Win32
 - **Backgrounds**: optional image with tile/stretch/fit/fill/anchor modes and opacity control. (known issues)
 - **Printing**: print and page setup dialogs.
 
-## Added Features
-
-- **Pin Window**: Pins the Notepad window to the front.
-- **Language Support**: Added new languages.
-- **Don't Prompt if Empty**: Does not display a confirmation message when saving an empty file without a title.
-
 ## Requirements
 
 - Windows 10/11 with Win32 and GDI+ (desktop apps)
@@ -83,4 +73,4 @@ MIT License — see [LICENSE](LICENSE).
 
 ## Queries
 
-[x.com/forloopcodes](https://x.com/forloopcodes)
+[x.com/forloopcodes](https://x.com/forloopcodes)
\ No newline at end of file
diff --git a/src/lang/en.h b/src/lang/en.h
index 28f88a6..fe19f71 100644
--- a/src/lang/en.h
+++ b/src/lang/en.h
@@ -98,7 +98,7 @@ inline LangStrings g_langEN = {
     L"Cannot open file.",
     L"Cannot save file.",
     L"Error",
-    L"Legacy Notepad v1.1.0\n\nA fast, lightweight text editor.\n\nBuilt with C++ and Win32 API.\n\nModify by 0x2o.net",
+    L"Legacy Notepad v1.1.1\n\nA fast, lightweight text editor.\n\nBuilt with C++ and Win32 API.\n", //\nModify by 0x2o.net",
 
     // Status bar
     L" Ln ",
diff --git a/src/lang/ja.h b/src/lang/ja.h
index 3914e02..fbd3368 100644
--- a/src/lang/ja.h
+++ b/src/lang/ja.h
@@ -98,7 +98,7 @@ inline LangStrings g_langJA = {
     L"ファイルを開けません。",
     L"ファイルを保存できません。",
     L"エラー",
-    L"Legacy Notepad v1.1.0\n\n高速で軽量なテキストエディタ。\n\nC++ Win32 API で構築。\n\nModify by 0x2o.net",
+    L"Legacy Notepad v1.1.1\n\n高速で軽量なテキストエディタ。\n\nC++ Win32 API で構築。\n",//\nModify by 0x2o.net",
 
     // Status bar
     L" 行 ",
